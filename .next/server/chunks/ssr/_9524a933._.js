module.exports=[84505,a=>{"use strict";let b=(0,a.i(70106).default)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);a.s(["Download",()=>b],84505)},41710,a=>{"use strict";let b=(0,a.i(70106).default)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);a.s(["Clock",()=>b],41710)},82588,a=>{"use strict";var b=a.i(87924),c=a.i(70382),d=a.i(28887),e=a.i(40695),f=a.i(3130),g=a.i(54161),h=a.i(25015),i=a.i(76472),j=a.i(84505),k=a.i(70106);let l=(0,k.default)("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);var m=a.i(41710);let n=(0,k.default)("Disc",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);var o=a.i(96221);let p=(0,k.default)("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]),q=(0,k.default)("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);var r=a.i(33441),s=a.i(72131),t=a.i(38246),u=a.i(69240),v=a.i(62535),w=a.i(50944);function x(){let a=(0,w.useParams)(),k=(0,w.useRouter)(),x=a.id,[y,z]=(0,s.useState)(!1),[A,B]=(0,s.useState)(null),[C,D]=(0,s.useState)(!0),[E,F]=(0,s.useState)(!1),[G,H]=(0,s.useState)(!1),[I,J]=(0,s.useState)(null),[K,L]=(0,s.useState)(0),[M,N]=(0,s.useState)(null),[O,P]=(0,s.useState)(!1),[Q,R]=(0,s.useState)(!1),[S,T]=(0,s.useState)(!1),[U,V]=(0,s.useState)(!1),{playPack:W,isPlaying:X,currentPack:Y}=(0,v.useAudioPlayer)(),Z=(0,u.createBrowserClient)();Y?.id,(0,s.useEffect)(()=>{(async()=>{try{let{data:a,error:b}=await Z.from("packs").select(`
            *,
            profiles (
              username,
              display_name,
              avatar_url
            )
          `).eq("id",x).single();if(b)throw b;console.log("[v0] Pack data loaded:",a),B(a),L(a.likes_count||0);let{data:c}=await Z.rpc("get_active_offer",{p_pack_id:x}).maybeSingle();c&&N(c)}catch(a){console.error("Error fetching pack:",a)}finally{D(!1)}})()},[x,Z]),(0,s.useEffect)(()=>{(async()=>{let{data:{user:a}}=await Z.auth.getUser();if(J(a),a&&x){let{data:b}=await Z.from("pack_likes").select("id").eq("user_id",a.id).eq("pack_id",x).maybeSingle();if(z(!!b),A?.user_id){T(a.id===A.user_id);let{data:b}=await Z.from("followers").select("id").eq("follower_id",a.id).eq("following_id",A.user_id).maybeSingle();P(!!b)}let{data:c}=await Z.from("purchases").select("id").eq("buyer_id",a.id).limit(1).maybeSingle();R(!!c)}})()},[x,A?.user_id,Z]);let $=async()=>{if(F(!0),A?.price===0)try{let a=await fetch(`/api/packs/${x}/download`);if(!a.ok){let b=await a.json();alert(b.error||"Error al descargar el pack"),F(!1);return}let b=await a.blob(),c=window.URL.createObjectURL(b),d=document.createElement("a");d.href=c,d.download=`${A.title.replace(/[^a-zA-Z0-9]/g,"_")}.zip`,document.body.appendChild(d),d.click(),window.URL.revokeObjectURL(c),document.body.removeChild(d),F(!1)}catch(a){console.error("Download error:",a),alert("Error al descargar el pack"),F(!1)}else window.location.href=`/pack/${x}/checkout`},_=async()=>{if(!I)return void alert("Inici치 sesi칩n para dar like a este pack");H(!0);try{if(y){let{error:a}=await Z.from("pack_likes").delete().eq("user_id",I.id).eq("pack_id",x);a||(z(!1),L(a=>Math.max(0,a-1)))}else{let{error:a}=await Z.from("pack_likes").insert({user_id:I.id,pack_id:x});a||(z(!0),L(a=>a+1))}}catch(a){console.error("Error toggling like:",a)}finally{H(!1)}},aa=async()=>{if(!A)return;let a=window.location.origin,b=`${a}/pack/${A.id}`;try{await navigator.clipboard.writeText(b),V(!0),setTimeout(()=>V(!1),2e3)}catch(a){console.error("Failed to copy link:",a)}},ab=a=>0===a?"GRATIS":new Intl.NumberFormat("es-AR",{style:"decimal",minimumFractionDigits:0,maximumFractionDigits:0}).format(a),[ac,ad]=(0,s.useState)(0),[ae,af]=(0,s.useState)("");return((0,s.useEffect)(()=>{A&&(()=>{A.price;let a=0,b="",c=Number(A.discount_percent)||0;if(0===A.price){ad(0),af("");return}if(M){let c=Number(M.discount_percent)||0;a=c,A.price,b=`Descuento activo del ${ab(c)}%`}else A.has_discount&&c>0&&c<=100&&(a=A.price*c/100,A.price,b=`${c}% de descuento`);ad(a),af(b)})()},[A,M,I,O,Q]),C)?(0,b.jsxs)("div",{className:"min-h-screen flex flex-col",children:[(0,b.jsx)(c.Header,{}),(0,b.jsx)("main",{className:"flex-1 container mx-auto px-4 py-12 flex items-center justify-center",children:(0,b.jsx)(o.Loader2,{className:"h-12 w-12 animate-spin text-primary"})}),(0,b.jsx)(d.Footer,{})]}):A?(0,b.jsxs)("div",{className:"min-h-screen flex flex-col",children:[(0,b.jsx)(c.Header,{}),(0,b.jsx)("main",{className:"flex-1 container mx-auto px-4 py-12",children:(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-12",children:[(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)(f.Card,{className:"overflow-hidden rounded-3xl border-border",children:(0,b.jsxs)("div",{className:"relative aspect-square bg-muted group overflow-hidden",children:[(0,b.jsx)("img",{src:A.cover_image_url||"/placeholder.svg?height=800&width=800",alt:A.title,className:"w-full h-full object-cover"}),(0,b.jsx)("div",{className:"absolute inset-0 bg-gradient-to-t from-black/80 via-black/40 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex items-center justify-center",children:(0,b.jsx)(e.Button,{size:"lg",className:"rounded-full h-24 w-24 p-0 bg-primary text-primary-foreground shadow-2xl hover:scale-110 transition-transform",onClick:()=>{A?.demo_audio_url&&W({id:A.id,title:A.title,producer:A.profiles?.username||"Usuario",image:A.cover_image_url||"/placeholder.svg",audioUrl:A.demo_audio_url})},disabled:!A.demo_audio_url,children:(0,b.jsx)(h.Play,{className:"h-10 w-10 ml-1",fill:"currentColor"})})}),A.genre&&(0,b.jsx)(g.Badge,{className:"absolute top-4 left-4 bg-primary text-primary-foreground font-bold px-4 py-2 text-sm",children:A.genre})]})}),(0,b.jsxs)("div",{className:"grid grid-cols-3 gap-3",children:[A.bpm&&(0,b.jsxs)(f.Card,{className:"p-4 text-center rounded-2xl border-border",children:[(0,b.jsx)(m.Clock,{className:"h-6 w-6 mx-auto mb-2 text-primary"}),(0,b.jsx)("div",{className:"text-xl font-black text-foreground",children:A.bpm}),(0,b.jsx)("div",{className:"text-xs text-muted-foreground",children:"BPM"})]}),(0,b.jsxs)(f.Card,{className:"p-4 text-center rounded-2xl border-border",children:[(0,b.jsx)(n,{className:"h-6 w-6 mx-auto mb-2 text-primary"}),(0,b.jsx)("div",{className:"text-xl font-black text-foreground",children:"WAV"}),(0,b.jsx)("div",{className:"text-xs text-muted-foreground",children:"Formato"})]}),(0,b.jsxs)(f.Card,{className:"p-4 text-center rounded-2xl border-border",children:[(0,b.jsx)(j.Download,{className:"h-6 w-6 mx-auto mb-2 text-primary"}),(0,b.jsx)("div",{className:"text-xl font-black text-foreground",children:A.downloads_count||0}),(0,b.jsx)("div",{className:"text-xs text-muted-foreground",children:"Descargas"})]})]})]}),(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-5xl font-black text-foreground mb-4 text-balance",children:A.title}),(0,b.jsxs)(t.default,{href:`/profile/${A.profiles?.username}`,className:"flex items-center gap-3 text-muted-foreground hover:text-primary transition-colors",children:[A.profiles?.avatar_url?(0,b.jsx)("img",{src:A.profiles.avatar_url||"/placeholder.svg",alt:A.profiles.username||"",className:"h-12 w-12 rounded-full object-cover"}):(0,b.jsx)("div",{className:"h-12 w-12 rounded-full bg-gradient-to-br from-primary to-secondary flex items-center justify-center text-white font-bold",children:(A.profiles?.username||"U")[0].toUpperCase()}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-sm text-muted-foreground",children:"Creado por"}),(0,b.jsx)("div",{className:"text-lg font-bold text-foreground",children:A.profiles?.username||"Usuario"})]})]})]}),(0,b.jsxs)(f.Card,{className:"p-6 rounded-3xl border-border bg-accent/50",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,b.jsx)("div",{children:0===A.price?(0,b.jsx)("div",{children:(0,b.jsx)("div",{className:"text-5xl font-black text-green-600",children:"GRATIS"})}):ac>0?(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"text-2xl font-bold text-muted-foreground line-through",children:["$",ab(A.price)]}),(0,b.jsxs)("div",{className:"text-5xl font-black text-primary",children:["$",ab(A.price-ac)]}),(0,b.jsxs)("div",{className:"text-sm text-orange-500 font-semibold mt-1",children:["Ahorr치s $",ab(ac)," ARS"]})]}):(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"text-5xl font-black text-foreground",children:["$",ab(A.price)]}),(0,b.jsx)("div",{className:"text-sm text-muted-foreground font-semibold",children:"ARS"})]})}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)(e.Button,{variant:"outline",size:"icon",className:"rounded-full h-12 w-12 bg-transparent relative",onClick:_,disabled:G,children:[(0,b.jsx)(i.Heart,{className:`h-5 w-5 transition-all ${y?"fill-red-500 text-red-500 scale-110":""} ${G?"animate-pulse":""}`}),K>0&&(0,b.jsx)("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs font-bold rounded-full h-5 w-5 flex items-center justify-center",children:K>99?"99+":K})]}),(0,b.jsx)(e.Button,{variant:"outline",size:"icon",className:"rounded-full h-12 w-12 bg-transparent",onClick:aa,disabled:!A,title:A?"Copiar enlace":"Pack no disponible",children:U?(0,b.jsx)(r.Check,{className:"h-5 w-5 text-green-500"}):(0,b.jsx)(l,{className:"h-5 w-5"})})]})]}),ae&&(A.has_discount||M)&&(0,b.jsx)("div",{className:"mb-4 p-3 rounded-xl bg-orange-500/10 border border-orange-500/20",children:(0,b.jsx)("p",{className:"text-sm font-semibold text-orange-600 text-center",children:ae})}),S?(0,b.jsxs)(e.Button,{className:"w-full gap-2 rounded-full h-14 text-base font-bold",onClick:()=>{k.push(`/pack/${x}/edit`)},children:[(0,b.jsx)(q,{className:"h-5 w-5"}),"Editar Pack"]}):(0,b.jsx)(e.Button,{className:"w-full gap-2 rounded-full h-14 text-base font-bold",onClick:$,disabled:E,children:E?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(o.Loader2,{className:"h-5 w-5 animate-spin"}),"Procesando..."]}):0===A.price?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(j.Download,{className:"h-5 w-5"}),"Descargar Gratis"]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(p,{className:"h-5 w-5"}),"Comprar Ahora"]})})]}),A.description&&(0,b.jsxs)(f.Card,{className:"p-6 rounded-3xl border-border",children:[(0,b.jsx)("h2",{className:"text-2xl font-black text-foreground mb-4",children:"Descripci칩n"}),(0,b.jsx)("p",{className:"text-muted-foreground leading-relaxed whitespace-pre-wrap",children:A.description})]}),A.tags&&A.tags.length>0&&(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-sm font-bold text-muted-foreground mb-3",children:"TAGS"}),(0,b.jsx)("div",{className:"flex flex-wrap gap-2",children:A.tags.map((a,c)=>(0,b.jsx)(g.Badge,{variant:"outline",className:"px-4 py-2 rounded-full border-border hover:bg-accent cursor-pointer",children:a},c))})]})]})]})}),(0,b.jsx)(d.Footer,{})]}):(0,b.jsxs)("div",{className:"min-h-screen flex flex-col",children:[(0,b.jsx)(c.Header,{}),(0,b.jsx)("main",{className:"flex-1 container mx-auto px-4 py-12",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("h1",{className:"text-3xl font-bold text-foreground mb-4",children:"Pack no encontrado"}),(0,b.jsx)(t.default,{href:"/",children:(0,b.jsx)(e.Button,{children:"Volver al inicio"})})]})}),(0,b.jsx)(d.Footer,{})]})}a.s(["default",()=>x],82588)}];

//# sourceMappingURL=_9524a933._.js.map